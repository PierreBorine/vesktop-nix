vesktop-nix
===========

Nix flake to configure [Vesktop](https://github.com/Vencord/Vesktop) using home-manager.

## How to use
Add as a flake input
```Nix
# flake.nix
inputs = {
  ...
  vesktop-nix = {
    url = "github:PierreBorine/vesktop-nix";
    inputs.nixpkgs.follows = "nixpkgs";
  };
  ...
};
...
```

Maximal example
```Nix
# home-manager.nix
{
  inputs,
  config,
  pkgs,
  ...
}: let
  # Using stylix colors
  base16CSS = with config.lib.stylix.colors;
    pkgs.writeText "base16.css" ''
      /**
      * @name Base16
      * @author home-manager
      * @version 0.0.0
      * @description Theme generated by Nix
      **/

      :root {
          --base00: #${base00};
          --base01: #${base01};
          --base02: #${base02};
          --base03: #${base03};
          --base04: #${base04};
          --base05: #${base05};
          --base06: #${base06};
          --base07: #${base07};
          --base08: #${base08};
          --base09: #${base09};
          --base0A: #${base0A};
          --base0B: #${base0B};
          --base0C: #${base0C};
          --base0D: #${base0D};
          --base0E: #${base0E};
          --base0F: #${base0F};
      }
    '';
in {
  imports = [ inputs.vesktop-nix.homeManagerModules.default ];
  
  programs.vesktop = {
    enable = true;
  
    # Additional local themes that can be turned on/off in Vesktop
    # Will create the following files in ~/.config/vesktop/themes
    # > base16.css
    # > themeTweaks.css
    themes = {
      base16 = base16CSS;
      themeTweaks = ./tweaks.css;
    };
  
    # Vencord's settings
    # Edits ~/.config/vesktop/settings/settings.json
    vencordSettings = {
      themeLinks = ["https://refact0r.github.io/system24/theme/flavors/spotify-text.theme.css"];
      frameless = true;

      # Configure plugins
      plugins = {
        petpet.enabled = true;
        OnePingPerDM = {
          enabled = true;
          allowMentions = true;
        };
      };
    };

    # Vesktop's settings
    # Edits ~/.config/vesktop/settings.json
    settings = {
      minimizeToTray = "on";
      hardwareAcceleration = false;
    };
  };
}
```

## Notes
- Both settings options utilize a `home.activation` script thus requiring a generation activation to apply.
- Settings defined with Nix needs Vesktop to restart in order to take effect.
- Vesktop's css automatically updates when a file in `programs.vesktop.themes` is changed.
